import bpy
from Sollumz.sollumz_properties import MaterialType
from collections import namedtuple 

CollisionMaterial = namedtuple("CollisionMat", ["name", "color"])

collisionmats = [
    CollisionMaterial("DEFAULT", (255, 0, 255, 255)),
    CollisionMaterial("CONCRETE", (145, 145, 145, 255)),
    CollisionMaterial("CONCRETE_POTHOLE", (145, 145, 145, 255)),
    CollisionMaterial("CONCRETE_DUSTY", (145, 140, 130, 255)),
    CollisionMaterial("TARMAC", (90, 90, 90, 255)),
    CollisionMaterial("TARMAC_PAINTED", (90, 90, 90, 255)),
    CollisionMaterial("TARMAC_POTHOLE", (70, 70, 70, 255)),
    CollisionMaterial("RUMBLE_STRIP", (90, 90, 90, 255)),
    CollisionMaterial("BREEZE_BLOCK", (145, 145, 145, 255)),
    CollisionMaterial("ROCK", (185, 185, 185, 255)),
    CollisionMaterial("ROCK_MOSSY", (185, 185, 185, 255)),
    CollisionMaterial("STONE", (185, 185, 185, 255)),
    CollisionMaterial("COBBLESTONE", (185, 185, 185, 255)),
    CollisionMaterial("BRICK", (195, 95, 30, 255)),
    CollisionMaterial("MARBLE", (195, 155, 145, 255)),
    CollisionMaterial("PAVING_SLAB", (200, 165, 130, 255)),
    CollisionMaterial("SANDSTONE_SOLID", (215, 195, 150, 255)),
    CollisionMaterial("SANDSTONE_BRITTLE", (205, 180, 120, 255)),
    CollisionMaterial("SAND_LOOSE", (235, 220, 190, 255)),
    CollisionMaterial("SAND_COMPACT", (250, 240, 220, 255)),
    CollisionMaterial("SAND_WET", (190, 185, 165, 255)),
    CollisionMaterial("SAND_TRACK", (250, 240, 220, 255)),
    CollisionMaterial("SAND_UNDERWATER", (135, 130, 120, 255)),
    CollisionMaterial("SAND_DRY_DEEP", (110, 100, 85, 255)),
    CollisionMaterial("SAND_WET_DEEP", (110, 100, 85, 255)),
    CollisionMaterial("ICE", (200, 250, 255, 255)),
    CollisionMaterial("ICE_TARMAC", (200, 250, 255, 255)),
    CollisionMaterial("SNOW_LOOSE", (255, 255, 255, 255)),
    CollisionMaterial("SNOW_COMPACT", (255, 255, 255, 255)),
    CollisionMaterial("SNOW_DEEP", (255, 255, 255, 255)),
    CollisionMaterial("SNOW_TARMAC", (255, 255, 255, 255)),
    CollisionMaterial("GRAVEL_SMALL", (255, 255, 255, 255)),
    CollisionMaterial("GRAVEL_LARGE", (255, 255, 255, 255)),
    CollisionMaterial("GRAVEL_DEEP", (255, 255, 255, 255)),
    CollisionMaterial("GRAVEL_TRAIN_TRACK", (145, 140, 130, 255)),
    CollisionMaterial("DIRT_TRACK", (175, 160, 140, 255)),
    CollisionMaterial("MUD_HARD", (175, 160, 140, 255)),
    CollisionMaterial("MUD_POTHOLE", (105, 95, 75, 255)),
    CollisionMaterial("MUD_SOFT", (105, 95, 75, 255)),
    CollisionMaterial("MUD_UNDERWATER", (75, 65, 50, 255)),
    CollisionMaterial("MUD_DEEP", (105, 95, 75, 255)),
    CollisionMaterial("MARSH", (105, 95, 75, 255)),
    CollisionMaterial("MARSH_DEEP", (105, 95, 75, 255)),
    CollisionMaterial("SOIL", (105, 95, 75, 255)),
    CollisionMaterial("CLAY_HARD", (160, 160, 160, 255)),
    CollisionMaterial("CLAY_SOFT", (160, 160, 160, 255)),
    CollisionMaterial("GRASS_LONG", (130, 205, 75, 255)),
    CollisionMaterial("GRASS", (130, 205, 75, 255)),
    CollisionMaterial("GRASS_SHORT", (130, 205, 75, 255)),
    CollisionMaterial("HAY", (240, 205, 125, 255)),
    CollisionMaterial("BUSHES", (85, 160, 30, 255)),
    CollisionMaterial("TWIGS", (115, 100, 70, 255)),
    CollisionMaterial("LEAVES", (70, 100, 50, 255)),
    CollisionMaterial("WOODCHIPS", (115, 100, 70, 255)),
    CollisionMaterial("TREE_BARK", (115, 100, 70, 255)),
    CollisionMaterial("METAL_SOLID_SMALL", (155, 180, 190, 255)),
    CollisionMaterial("METAL_SOLID_MEDIUM", (155, 180, 190, 255)),
    CollisionMaterial("METAL_SOLID_LARGE", (155, 180, 190, 255)),
    CollisionMaterial("METAL_HOLLOW_SMALL", (155, 180, 190, 255)),
    CollisionMaterial("METAL_HOLLOW_MEDIUM", (155, 180, 190, 255)),
    CollisionMaterial("METAL_HOLLOW_LARGE", (155, 180, 190, 255)),
    CollisionMaterial("METAL_CHAINLINK_SMALL", (155, 180, 190, 255)),
    CollisionMaterial("METAL_CHAINLINK_LARGE", (155, 180, 190, 255)),
    CollisionMaterial("METAL_CORRUGATED_IRON", (155, 180, 190, 255)),
    CollisionMaterial("METAL_GRILLE", (155, 180, 190, 255)),
    CollisionMaterial("METAL_RAILING", (155, 180, 190, 255)),
    CollisionMaterial("METAL_DUCT", (155, 180, 190, 255)),
    CollisionMaterial("METAL_GARAGE_DOOR", (155, 180, 190, 255)),
    CollisionMaterial("METAL_MANHOLE", (155, 180, 190, 255)),
    CollisionMaterial("WOOD_SOLID_SMALL", (155, 130, 95, 255)),
    CollisionMaterial("WOOD_SOLID_MEDIUM", (155, 130, 95, 255)),
    CollisionMaterial("WOOD_SOLID_LARGE", (155, 130, 95, 255)),
    CollisionMaterial("WOOD_SOLID_POLISHED", (155, 130, 95, 255)),
    CollisionMaterial("WOOD_FLOOR_DUSTY", (165, 145, 110, 255)),
    CollisionMaterial("WOOD_HOLLOW_SMALL", (170, 150, 125, 255)),
    CollisionMaterial("WOOD_HOLLOW_MEDIUM", (170, 150, 125, 255)),
    CollisionMaterial("WOOD_HOLLOW_LARGE", (170, 150, 125, 255)),
    CollisionMaterial("WOOD_CHIPBOARD", (170, 150, 125, 255)),
    CollisionMaterial("WOOD_OLD_CREAKY", (155, 130, 95, 255)),
    CollisionMaterial("WOOD_HIGH_DENSITY", (155, 130, 95, 255)),
    CollisionMaterial("WOOD_LATTICE", (155, 130, 95, 255)),
    CollisionMaterial("CERAMIC", (220, 210, 195, 255)),
    CollisionMaterial("ROOF_TILE", (220, 210, 195, 255)),
    CollisionMaterial("ROOF_FELT", (165, 145, 110, 255)),
    CollisionMaterial("FIBREGLASS", (255, 250, 210, 255)),
    CollisionMaterial("TARPAULIN", (255, 250, 210, 255)),
    CollisionMaterial("PLASTIC", (255, 250, 210, 255)),
    CollisionMaterial("PLASTIC_HOLLOW", (240, 230, 185, 255)),
    CollisionMaterial("PLASTIC_HIGH_DENSITY", (255, 250, 210, 255)),
    CollisionMaterial("PLASTIC_CLEAR", (255, 250, 210, 255)),
    CollisionMaterial("PLASTIC_HOLLOW_CLEAR", (240, 230, 185, 255)),
    CollisionMaterial("PLASTIC_HIGH_DENSITY_CLEAR", (255, 250, 210, 255)),
    CollisionMaterial("FIBREGLASS_HOLLOW", (240, 230, 185, 255)),
    CollisionMaterial("RUBBER", (70, 70, 70, 255)),
    CollisionMaterial("RUBBER_HOLLOW", (70, 70, 70, 255)),
    CollisionMaterial("LINOLEUM", (205, 150, 80, 255)),
    CollisionMaterial("LAMINATE", (170, 150, 125, 255)),
    CollisionMaterial("CARPET_SOLID", (250, 100, 100, 255)),
    CollisionMaterial("CARPET_SOLID_DUSTY", (255, 135, 135, 255)),
    CollisionMaterial("CARPET_FLOORBOARD", (250, 100, 100, 255)),
    CollisionMaterial("CLOTH", (250, 100, 100, 255)),
    CollisionMaterial("PLASTER_SOLID", (145, 145, 145, 255)),
    CollisionMaterial("PLASTER_BRITTLE", (225, 225, 225, 255)),
    CollisionMaterial("CARDBOARD_SHEET", (120, 115, 95, 255)),
    CollisionMaterial("CARDBOARD_BOX", (120, 115, 95, 255)),
    CollisionMaterial("PAPER", (230, 225, 220, 255)),
    CollisionMaterial("FOAM", (230, 235, 240, 255)),
    CollisionMaterial("FEATHER_PILLOW", (230, 230, 230, 255)),
    CollisionMaterial("POLYSTYRENE", (255, 250, 210, 255)),
    CollisionMaterial("LEATHER", (250, 100, 100, 255)),
    CollisionMaterial("TVSCREEN", (115, 125, 125, 255)),
    CollisionMaterial("SLATTED_BLINDS", (255, 250, 210, 255)),
    CollisionMaterial("GLASS_SHOOT_THROUGH", (205, 240, 255, 255)),
    CollisionMaterial("GLASS_BULLETPROOF", (115, 125, 125, 255)),
    CollisionMaterial("GLASS_OPAQUE", (205, 240, 255, 255)),
    CollisionMaterial("PERSPEX", (205, 240, 255, 255)),
    CollisionMaterial("CAR_METAL", (255, 255, 255, 255)),
    CollisionMaterial("CAR_PLASTIC", (255, 255, 255, 255)),
    CollisionMaterial("CAR_SOFTTOP", (250, 100, 100, 255)),
    CollisionMaterial("CAR_SOFTTOP_CLEAR", (250, 100, 100, 255)),
    CollisionMaterial("CAR_GLASS_WEAK", (210, 245, 245, 255)),
    CollisionMaterial("CAR_GLASS_MEDIUM", (210, 245, 245, 255)),
    CollisionMaterial("CAR_GLASS_STRONG", (210, 245, 245, 255)),
    CollisionMaterial("CAR_GLASS_BULLETPROOF", (210, 245, 245, 255)),
    CollisionMaterial("CAR_GLASS_OPAQUE", (210, 245, 245, 255)),
    CollisionMaterial("WATER", (55, 145, 230, 255)),
    CollisionMaterial("BLOOD", (205, 5, 5, 255)),
    CollisionMaterial("OIL", (80, 65, 65, 255)),
    CollisionMaterial("PETROL", (70, 100, 120, 255)),
    CollisionMaterial("FRESH_MEAT", (255, 55, 20, 255)),
    CollisionMaterial("DRIED_MEAT", (185, 100, 85, 255)),
    CollisionMaterial("EMISSIVE_GLASS", (205, 240, 255, 255)),
    CollisionMaterial("EMISSIVE_PLASTIC", (255, 250, 210, 255)),
    CollisionMaterial("VFX_METAL_ELECTRIFIED", (155, 180, 190, 255)),
    CollisionMaterial("VFX_METAL_WATER_TOWER", (155, 180, 190, 255)),
    CollisionMaterial("VFX_METAL_STEAM", (155, 180, 190, 255)),
    CollisionMaterial("VFX_METAL_FLAME", (155, 180, 190, 255)),
    CollisionMaterial("PHYS_NO_FRICTION", (0, 0, 0, 255)),
    CollisionMaterial("PHYS_GOLF_BALL", (0, 0, 0, 255)),
    CollisionMaterial("PHYS_TENNIS_BALL", (0, 0, 0, 255)),
    CollisionMaterial("PHYS_CASTER", (0, 0, 0, 255)),
    CollisionMaterial("PHYS_CASTER_RUSTY", (0, 0, 0, 255)),
    CollisionMaterial("PHYS_CAR_VOID", (0, 0, 0, 255)),
    CollisionMaterial("PHYS_PED_CAPSULE", (0, 0, 0, 255)),
    CollisionMaterial("PHYS_ELECTRIC_FENCE", (0, 0, 0, 255)),
    CollisionMaterial("PHYS_ELECTRIC_METAL", (0, 0, 0, 255)),
    CollisionMaterial("PHYS_BARBED_WIRE", (0, 0, 0, 255)),
    CollisionMaterial("PHYS_POOLTABLE_SURFACE", (155, 130, 95, 255)),
    CollisionMaterial("PHYS_POOLTABLE_CUSHION", (155, 130, 95, 255)),
    CollisionMaterial("PHYS_POOLTABLE_BALL", (255, 250, 210, 255)),
    CollisionMaterial("BUTTOCKS", (0, 0, 0, 255)),
    CollisionMaterial("THIGH_LEFT", (0, 0, 0, 255)),
    CollisionMaterial("SHIN_LEFT", (0, 0, 0, 255)),
    CollisionMaterial("FOOT_LEFT", (0, 0, 0, 255)),
    CollisionMaterial("THIGH_RIGHT", (0, 0, 0, 255)),
    CollisionMaterial("SHIN_RIGHT", (0, 0, 0, 255)),
    CollisionMaterial("FOOT_RIGHT", (0, 0, 0, 255)),
    CollisionMaterial("SPINE0", (0, 0, 0, 255)),
    CollisionMaterial("SPINE1", (0, 0, 0, 255)),
    CollisionMaterial("SPINE2", (0, 0, 0, 255)),
    CollisionMaterial("SPINE3", (0, 0, 0, 255)),
    CollisionMaterial("CLAVICLE_LEFT", (0, 0, 0, 255)),
    CollisionMaterial("UPPER_ARM_LEFT", (0, 0, 0, 255)),
    CollisionMaterial("LOWER_ARM_LEFT", (0, 0, 0, 255)),
    CollisionMaterial("HAND_LEFT", (0, 0, 0, 255)),
    CollisionMaterial("CLAVICLE_RIGHT", (0, 0, 0, 255)),
    CollisionMaterial("UPPER_ARM_RIGHT", (0, 0, 0, 255)),
    CollisionMaterial("LOWER_ARM_RIGHT", (0, 0, 0, 255)),
    CollisionMaterial("HAND_RIGHT", (0, 0, 0, 255)),
    CollisionMaterial("NECK", (0, 0, 0, 255)),
    CollisionMaterial("HEAD", (0, 0, 0, 255)),
    CollisionMaterial("ANIMAL_DEFAULT", (0, 0, 0, 255)),
    CollisionMaterial("CAR_ENGINE", (255, 255, 255, 255)),
    CollisionMaterial("PUDDLE", (55, 145, 230, 255)),
    CollisionMaterial("CONCRETE_PAVEMENT", (145, 145, 145, 255)),
    CollisionMaterial("BRICK_PAVEMENT", (195, 95, 30, 255)),
    CollisionMaterial("PHYS_DYNAMIC_COVER_BOUND", (0, 0, 0, 255)),
    CollisionMaterial("VFX_WOOD_BEER_BARREL", (155, 130, 95, 255)),
    CollisionMaterial("WOOD_HIGH_FRICTION", (155, 130, 95, 255)),
    CollisionMaterial("ROCK_NOINST", (185, 185, 185, 255)),
    CollisionMaterial("BUSHES_NOINST", (85, 160, 30, 255)),
    CollisionMaterial("METAL_SOLID_ROAD_SURFACE", (155, 180, 190, 255)),
]


def create_collision_material_from_index(collisionindex: int):

    matinfo = collisionmats[collisionindex]

    mat = bpy.data.materials.new(matinfo.name)
    mat.sollum_type = MaterialType.COLLISION
    mat.collision_properties.collision_index = collisionindex
    mat.use_nodes = True
    r = matinfo.color[0] / 255
    g = matinfo.color[1] / 255
    b = matinfo.color[2] / 255
    mat.node_tree.nodes["Principled BSDF"].inputs[0].default_value = (r, g, b, 1)

    return mat
